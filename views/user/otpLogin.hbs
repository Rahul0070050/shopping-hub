<div class="contsiner-fluid otp-login-container">
    <div class="row">
        <div class="col-lg-12">
            <form>
                <h4><strong>OPT Login</strong><span id="count-down">0:59</span></h4>
                <div class="form-group">
                    <label for="exampleInputEmail1"><img
                            src="data:image/png;base64,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"
                            alt=""><strong>Check your phone</strong></label>
                    <input type="number" class="form-control" id="form-control" aria-describedby="mobileHelp"
                        placeholder="Enter email">
                    <div id="validationServer04Feedback" class="invalid-feedback">
                        Time is expired resend otp or signin another way
                    </div>
                    <span id="mobileHelp">OTP must be 6 digits</span>
                </div>
                <div class="otp-options mb-2">
                    <span id="resend-otp">Resend OTP</span>
                    <span class="float-right">Sign in another way</span>
                </div>
                <button type="button" id="sibmit-btn" class="btn btn-primary"><span id="span-spinner"></span>
                    Submit</button>
            </form>
        </div>
    </div>
</div>


<script>
    (function () {
        const countDown = document.getElementById('count-down');
        const inputField = document.getElementById('form-control');
        const spanSpinner = document.getElementById('span-spinner');
        const submitButton = document.getElementById('sibmit-btn');
        const resendOtp = document.getElementById('resend-otp');
        function otpTimer() {
            let counter = 60
            inputField.focus()
            let timer = setInterval(() => {
                countDown.innerText = counter < 10 ? `0:0${--counter}` : `0:${--counter}`
                if (counter <= 0) {
                    clearInterval(timer)
                    submitButton.setAttribute('disabled', true)
                    inputField.setAttribute('disabled', true)
                    inputField.classList.add('is-invalid')
                }
            }, 1000)
            return timer
        }
        let timer = otpTimer()
        resendOtp.addEventListener('click', () => {
            clearInterval(timer)
            timer = otpTimer()
        })
        submitButton.addEventListener('click', () => {
            //
        })
        inputField.addEventListener('keyup', (e) => {
            let value = e.target.value;
            if (value.length == 6) {
                clearInterval(timer)
                submitButton.setAttribute('disabled', true)
                inputField.setAttribute('disabled', true)
                spanSpinner.classList.add('spinner-border', 'spinner-border-sm')
                fetch('/user/checkotp', {
                    method: 'POST',
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        otp: value
                    }),
                    credentials: 'include'
                }).then(res => res.json()).then(res => {
                    console.log(res)
                    if (res.ok) {
                        let a = document.createElement('a');
                        a.setAttribute('href', '/')
                        a.click()
                    } else {
                        console.log(res)
                    }
                })
            }
        })
    })()
</script>