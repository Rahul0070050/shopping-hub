<div class="container-fluid" id="admin-product-table">
    <table id="dt-select" class="table table-striped table-bordered" cellspacing="0" width="100%">
        {{!-- <button id="filter-btn" class="btn"><img src="/image/icons/filter.png" alt="">Filer</button> --}}
        <a href="/admin/add_product" class="btn btn-success float-right mb-4 text-white">add product</a>
        <thead>
            <tr>
                <th>Image</th>
                <th>Name</th>
                <th>Caategory</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Discount</th>
            </tr>
        </thead>
        {{#each products}}
        <tfoot>
            <tr class="text-center">
                <th class="admin-products-table-view">
                    <a href="/admin/viewProduct/{{_id}}">
                        <img src="/image/productImages/{{mainImage}}" alt="">
                    </a>
                </th>
                <th>
                    <a href="/admin/viewProduct/{{_id}}">
                        {{name}}
                    </a>
                </th>
                <th>
                    <a href="/admin/viewProduct/{{_id}}">
                        {{category}}
                    </a>
                </th>
                <th>
                    <a href="/admin/viewProduct/{{_id}}">
                        {{price}}
                    </a>
                </th>
                <th>
                    <a href="/admin/viewProduct/{{_id}}">
                        {{quantity}}
                    </a>
                </th>
                <th>
                    <a href="/admin/viewProduct/{{_id}}">
                        {{discount}} %
                    </a>
                </th>
                <th>
                    <button onclick="deleteProduct(event)" product-id="{{_id}}" class="btn btn-danger">
                        Delete
                    </button>
                </th>
            </tr>
        </tfoot>
        {{/each}}
    </table>
</div>

<script>
    function deleteProduct(e) {
        let id = e.target.getAttribute('product-id')
        fetch('/admin/deleteProduct/', {
            method: 'delete',
            body: JSON.stringify({ id }),
            headers: { 'Content-Type': 'application/json' }
        }).then(res => res.json()).then(result => {
            location.reload()
        })
    }
</script>